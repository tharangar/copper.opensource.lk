{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Overview Email is the most reliable official communication method in current coporate environments. But Most companies are not willing to host their servers in remote cloud servers due to security issues. Futher Its cost is also high. But maintaining their own email server is one of prime goal in companies IT units. Copper Email Solution Copper Email System is the solution developed by Lanka Software Foundation for those issues in the corporate sector. Obviously it is free and opensource. Its repositoty is open for any one to contribute. Further this solution is deployed over Kubernetes which is most advanced cloud server deplyment (Ochestration) framework in the world now. Lanka Software Foundation (LSF) Lanka Software Foundation (LSF) was established in 2003 as a company limited by guarantee and as \u201cnot for profit\u201d organization with the vision of positioning Sri Lanka as a \u201cglobal Free and Open Source (FOSS) Research Development hub\u201d. Refferences Copper main repository is it's github repository. For Github repository visit copper.github . Open source email solutions like : emailserver Mail solution with rspamd Tomav openLdap solutions RSPAMD Group office Groupware GroupOffice Contact us If you have any questions or doubts about Cu, please reach us via You can contact us","title":"Overview"},{"location":"#overview","text":"Email is the most reliable official communication method in current coporate environments. But Most companies are not willing to host their servers in remote cloud servers due to security issues. Futher Its cost is also high. But maintaining their own email server is one of prime goal in companies IT units.","title":"Overview"},{"location":"#copper-email-solution","text":"Copper Email System is the solution developed by Lanka Software Foundation for those issues in the corporate sector. Obviously it is free and opensource. Its repositoty is open for any one to contribute. Further this solution is deployed over Kubernetes which is most advanced cloud server deplyment (Ochestration) framework in the world now.","title":"Copper Email Solution"},{"location":"#lanka-software-foundation-lsf","text":"Lanka Software Foundation (LSF) was established in 2003 as a company limited by guarantee and as \u201cnot for profit\u201d organization with the vision of positioning Sri Lanka as a \u201cglobal Free and Open Source (FOSS) Research Development hub\u201d.","title":"Lanka Software Foundation (LSF)"},{"location":"#refferences","text":"Copper main repository is it's github repository. For Github repository visit copper.github . Open source email solutions like : emailserver Mail solution with rspamd Tomav openLdap solutions RSPAMD Group office Groupware GroupOffice","title":"Refferences"},{"location":"#contact-us","text":"If you have any questions or doubts about Cu, please reach us via You can contact us","title":"Contact us"},{"location":"Backups/","text":"Backups Backups and restoration is requied to ensure bussiness continuty in any corporate environment. Copper Email solution is bit complex so it has varity of data sources to be backed up. Still this backup and restoration part is not completed, this is the initila plan and hope to complete backup with suitable backup management system with encription . Even though backing up is automated there should be a possibility to manually run the backup process too. Further restoraion is also should be done using latest backups from a shell coammand. Copper system has 4 main data to make sure system is successfully backed up. secret.yaml tls folder which has key files data folder which has email maildir groupoffice database backup Above data will be backed up daily in a local repository and central repository which can be restored in any occation by system administrator from his local repository. This central repository will be handled by Hub. Initial deploy script will check whether there is secret.yaml and if it exits it will ask to deploy it and if not it will create new one with user inputs. After initial installation another script should run to populate groupoffice database backto the database, tls files and maildir back in place.","title":"Backup & Restoration"},{"location":"Backups/#backups","text":"Backups and restoration is requied to ensure bussiness continuty in any corporate environment. Copper Email solution is bit complex so it has varity of data sources to be backed up. Still this backup and restoration part is not completed, this is the initila plan and hope to complete backup with suitable backup management system with encription . Even though backing up is automated there should be a possibility to manually run the backup process too. Further restoraion is also should be done using latest backups from a shell coammand. Copper system has 4 main data to make sure system is successfully backed up. secret.yaml tls folder which has key files data folder which has email maildir groupoffice database backup Above data will be backed up daily in a local repository and central repository which can be restored in any occation by system administrator from his local repository. This central repository will be handled by Hub. Initial deploy script will check whether there is secret.yaml and if it exits it will ask to deploy it and if not it will create new one with user inputs. After initial installation another script should run to populate groupoffice database backto the database, tls files and maildir back in place.","title":"Backups"},{"location":"CConfiguration/","text":"Welcome to MkDocs Groupoffice is a featurefull gropware bundle.","title":"Client Configuration"},{"location":"CConfiguration/#welcome-to-mkdocs","text":"Groupoffice is a featurefull gropware bundle.","title":"Welcome to MkDocs"},{"location":"Configuration/","text":"Initial Configuration After successfully installation suing shell file then Basic configurations requied to make sure that the systme is up and running inorder. First you have to check userbase using phpldapadmin interface and then configure groupoffice to access your email server. thats it. Testing phpldapadmin user management URL :https://localhost:4433 // Hear the read only usr name and pasword should be provided for cn. Ex : username : cn=readonly,dc=copper,dc=opensource,dc=lk password : readonlypassword - Once successully loged in then you have to import some test users creation file (ldap.ldif). Importing ldap.ldif created while installation from phpldapadmin. Testing RSPAMD RSPAMD is the spam filtering service in this email solution. URL :http://localhost:11334/ - Password : password provided at installation step Configure groupoffice URL :http://localhost:8004 You will see the installation page of the groupoffice package. First create the admin user and start installation. Then login from the admin user name and start the configuration. Groupoffice is a userfriendly groupware and it has all coloborative tools which are requied for any organization in the world now. Next groupoffice groupware should be configured to work with email server. It is must to follow bellow steps to make sure you have successfuly connected with the emailserver and openldap server. Adding LDAP Authenticaiton module to the GroupOffice Login as admin Then go to Admin menu - Modules and add checked on community - LDAP Authenticator Then go to System setting and Authentication . If it has not LDAP section then refresh the page. Clikc on \"+\" mark to add ldap connection provide following parameters. Then refresh the page and go to System setting -- Authentication tab Interface of Authentication tab. Configure LDAP Server Domains : Domain name configured for ldap server Hostname : LDAP server host name Protocol : LDAP protocol ENCRIPTION : TLS Checked on Use Authentication Provide Username and password for ldap readonly user. Ex : usrname : cn=raa,dc=copper,dc=test,dc=lk Ex : password : XXXX Userbase details of LDAP server username attribute : uid peopleDN : Ex : ou=Users,dc=copper,dc=test,dc=lk groupDN : Ex : ou=groups,dc=copper,dc=test,dc=lk Check on create email server for users These all configurations are in same interface. IMAP server configuration IMAP Host : email Port : 143 Encription: TLS Ubcheck validate certificate SMTP server configuration HOST : email Port : 587 Check on use user credentials. Encription : TLS Uncheck validate certificate Users adding to a group Finaly add the user to the Internal group Now groupoffice configuration is complete. Then you can can log using your email account to group office for your domain. GroupOffice mail client. Password change for users. By default test users password is set to \"coppermail@lsf\" or when system admin set a password for specific users it will be known to administrator. So once a new user log in to the system after admin provided the credential user has to change the password. There is a seperate interface for this perpose. use provide the usernmae , current password, new password and confirme new password. https://localhost:4343/service/ use provide the usernmae , current password, new password and confirme new password. Thats it . Usre's account is users now.","title":"Initial Configuration"},{"location":"Configuration/#initial-configuration","text":"After successfully installation suing shell file then Basic configurations requied to make sure that the systme is up and running inorder. First you have to check userbase using phpldapadmin interface and then configure groupoffice to access your email server. thats it.","title":"Initial Configuration"},{"location":"Configuration/#testing-phpldapadmin-user-management","text":"URL :https://localhost:4433 // Hear the read only usr name and pasword should be provided for cn. Ex : username : cn=readonly,dc=copper,dc=opensource,dc=lk password : readonlypassword - Once successully loged in then you have to import some test users creation file (ldap.ldif). Importing ldap.ldif created while installation from phpldapadmin.","title":"Testing phpldapadmin user management"},{"location":"Configuration/#testing-rspamd","text":"RSPAMD is the spam filtering service in this email solution. URL :http://localhost:11334/ - Password : password provided at installation step","title":"Testing RSPAMD"},{"location":"Configuration/#configure-groupoffice","text":"URL :http://localhost:8004 You will see the installation page of the groupoffice package. First create the admin user and start installation. Then login from the admin user name and start the configuration. Groupoffice is a userfriendly groupware and it has all coloborative tools which are requied for any organization in the world now. Next groupoffice groupware should be configured to work with email server. It is must to follow bellow steps to make sure you have successfuly connected with the emailserver and openldap server.","title":"Configure groupoffice"},{"location":"Configuration/#adding-ldap-authenticaiton-module-to-the-groupoffice","text":"Login as admin Then go to Admin menu - Modules and add checked on community - LDAP Authenticator Then go to System setting and Authentication . If it has not LDAP section then refresh the page. Clikc on \"+\" mark to add ldap connection provide following parameters. Then refresh the page and go to System setting -- Authentication tab Interface of Authentication tab.","title":"Adding LDAP Authenticaiton module to the GroupOffice"},{"location":"Configuration/#configure-ldap-server","text":"Domains : Domain name configured for ldap server Hostname : LDAP server host name Protocol : LDAP protocol ENCRIPTION : TLS Checked on Use Authentication Provide Username and password for ldap readonly user. Ex : usrname : cn=raa,dc=copper,dc=test,dc=lk Ex : password : XXXX Userbase details of LDAP server username attribute : uid peopleDN : Ex : ou=Users,dc=copper,dc=test,dc=lk groupDN : Ex : ou=groups,dc=copper,dc=test,dc=lk Check on create email server for users These all configurations are in same interface.","title":"Configure LDAP Server"},{"location":"Configuration/#imap-server-configuration","text":"IMAP Host : email Port : 143 Encription: TLS Ubcheck validate certificate","title":"IMAP server configuration"},{"location":"Configuration/#smtp-server-configuration","text":"HOST : email Port : 587 Check on use user credentials. Encription : TLS Uncheck validate certificate","title":"SMTP server configuration"},{"location":"Configuration/#users-adding-to-a-group","text":"Finaly add the user to the Internal group Now groupoffice configuration is complete. Then you can can log using your email account to group office for your domain. GroupOffice mail client.","title":"Users adding to a group"},{"location":"Configuration/#password-change-for-users","text":"By default test users password is set to \"coppermail@lsf\" or when system admin set a password for specific users it will be known to administrator. So once a new user log in to the system after admin provided the credential user has to change the password. There is a seperate interface for this perpose. use provide the usernmae , current password, new password and confirme new password. https://localhost:4343/service/ use provide the usernmae , current password, new password and confirme new password. Thats it . Usre's account is users now.","title":"Password change for users."},{"location":"Features/","text":"Features Copper Email Solution has been integrated many industry leading applicaitons to ensure most featurefull and secured email solution is delevered. Knowing each tool it was used will be good approach to know the solution well. MTA (Mail Transfer Agent ) - POSTFIX Postfix has been selected as the MTA in copper solution due to some of following advantages we found in postfix. To allow the server to send external emails, an MTA such as Sendmail, Postfix, or Exim is required. Mail is read either through direct access (shell login) or mailbox protocols like POP and IMAP. Postfix If you compare mail servers, then Postfix should be included, too, because it is also a popular mail server. It is a better mail server because it supports most of the current innovations in a modern-day mail server including but not limited to: \u2022 Virtual domains \u2022 SMTP relay \u2022 Consultation of SMTP client on its whitelist, grey list and blacklist databases \u2022 Host and user masquerading \u2022 Delivery to mailboxes with Maildir format As you compare mail servers, you will observe that Postfix utilises two large monolithic configuration files instead of the multiple task-oriented configuration files. You will then have to learn a single set of configuration file keywords. So we selected postfix considering It's popularity in integration projects and adaptability with new featues too. Simple SMTP server. POSTFIX . MDA (Mail Delevery Agent) - DOVECOT Dovecot is an open source IMAP and POP3 email server for Linux/UNIX-like systems, written with security primarily in mind. Dovecot is an excellent choice for both small and large installations. It's fast, simple to set up, requires no special administration and it uses very little memory. Dovecot Advantages Best performing Standards compliant Clustered filesystems compatibilty Flexible authentification postfix and exim supprt for smtp authentication Security Flexible IMAP server. DOVECOT . SPAM FILTER - RSPAMD Rspamd is an advanced spam filtering system that allows evaluation of messages by a number of rules including regular expressions, statistical analysis and custom services such as URL black lists. Each message is analysed by Rspamd and given a spam score. According to this spam score and the user\u2019s settings, Rspamd recommends an action for the MTA to apply to the message, for example, to pass, reject or add a header. Rspamd is designed to process hundreds of messages per second simultaneously, and provides a number of useful features. Here is the list of C modules available bundled with rspamd. chartable: checks character sets of text parts in messages. dkim: performs DKIM signatures checks. fuzzy_check: checks messages fuzzy hashes against public blacklists. spf: checks SPF records for messages processed. surbl: this module extracts URLs from messages and check them against public DNS black lists to filter messages with malicious URLs. regexp: the core module that allow to define regexp rules, rspamd internal functions and lua rules. Lua modules Lua modules are dynamically loaded on rspamd startup and are reloaded on rspamd reconfiguration. Should you want to write a lua module consult with the Lua API documentation. To define path to lua modules there is a special section named modules in rspamd: modules { path = /path/to/dir/ ; path = /path/to/module.lua ; path = $PLUGINSDIR/lua ; } If a path is a directory then rspamd scans it for `*.lua\u201d pattern and load all files matched. The following Lua modules are enabled in the default configuration (but may require additional configuration to work, see notes below): antivirus - integrates virus scanners (requires configuration) arc - checks and signs ARC signatures asn - looks up ASN-related information etc * * Fast, free and open-source spam filtering. RSPAMD Comparisson with other spam filters. SPAM FILTERS SPF - Sender Policy Framework Sender Policy Framework (SPF) is an email authentication method designed to detect forged sender addresses in emails (email spoofing), a technique often used in phishing and email spam. SPF allows the receiver to check that an email claiming to come from a specific domain comes from an IP address authorized by that domain's administrators. The list of authorized sending hosts and IP addresses for a domain is published in the DNS records for that domain. Authorize email senders with SPF Help prevent spoofing from your domain Set up SPF to prevent spammers from sending unauthorized emails from your domain. This type of spamming is called spoofing. Sender Policy Framework (SPF) is an email security method to prevent spoofing from your domain. Spoofing is a common unauthorized use of email, so some email servers require SPF. If you don't set up SPF for your domain, messages could bounce or could be marked as spam. Use SPF with DKIM and DMARC Along with SPF, we recommend setting up DomainKeys Identified Mail (DKIM) and Domain-based Message Authentication, Reporting Conformance (DMARC). SPF validates the domains that can send messages. DKIM verifies that message content is authentic and not changed. DMARC specifies how your domain handles suspicious emails that it gets. Create an SPF record for your domain An SPF record is a TXT record that lists the mail servers that are allowed to send email from your domain. Messages sent from a server that isn't the SPF record might be marked as spam. SPF originally used TXT records in DNS, which are supposed to be free-form text with no semantics attached. SPF proponents readily acknowledge that it would be better to have records specifically designated for SPF, but this choice was made to enable rapid implementation of SPF. In July 2005, IANA assigned the Resource Record type 99 to SPF. Later on, the use of SPF records was discontinued, and as of 2017, it is still necessary to use TXT records. Fast, free and open-source spam filtering. SPF Create TXT Record in DNS for SPF . TXT Record Creation DKIM - DomainKeys Identified Mail DomainKeys Identified Mail (DKIM) lets an organization take responsibility for a message that is in transit. The organization is a handler of the message, either as its originator or as an intermediary. Their reputation is the basis for evaluating whether to trust the message for further handling, such as delivery. Technically DKIM provides a method for validating a domain name identity that is associated with a message through cryptographic authentication. DKIM allows the receiver to check that an email claimed to have come from a specific domain was indeed authorized by the owner of that domain. It achieves this by affixing a digital signature, linked to a domain name, to each outgoing email message. The recipient system can verify this by looking up the sender's public key published in the DNS. A valid signature also guarantees that some parts of the email (possibly including attachments) have not been modified since the signature was affixed. Usually, DKIM signatures are not visible to end-users, and are affixed or verified by the infrastructure rather than the message's authors and recipients. DomainKeys Identified Mail . DKIM DKIM technical specification. DKIM SPECIFICATION DMARK - Domain-based Message Authentication, Reporting Conformance DMARC, which stands for \u201cDomain-based Message Authentication, Reporting & Conformance\u201d, is an email authentication, policy, and reporting protocol. It builds on the widely deployed SPF and DKIM protocols, adding linkage to the author (\u201cFrom:\u201d) domain name, published policies for recipient handling of authentication failures, and reporting from receivers to senders, to improve and monitor protection of the domain from fraudulent email. DMARC is designed to fit into an organization\u2019s existing inbound email authentication process. The way it works is to help email receivers determine if the purported message \u201caligns\u201d with what the receiver knows about the sender. If not, DMARC includes guidance on how to handle the \u201cnon-aligned\u201d messages. For example, assuming that a receiver deploys SPF and DKIM, plus its own spam filters, the flow may look something like this: Domain-based Message Authentication, Reporting Conformance . DMARK OPENLDAP - Openldap is used as the userbase and email server domain configuration management portal. OpenLDAP is a free, open-source implementation of the Lightweight Directory Access Protocol (LDAP) developed by the OpenLDAP Project. It is released under its own BSD-style license called the OpenLDAP Public License. LDAP is a platform-independent protocol. Several common Linux distributions include OpenLDAP Software for LDAP support. The software also runs on BSD-variants, as well as AIX, Android, HP-UX, macOS, Solaris, Microsoft Windows (NT and derivatives, e.g. 2000, XP, Vista, Windows 7, etc.), and z/OS. OpenLDAP has three main components: slapd \u2013 stand-alone LDAP daemon and associated modules and tools libraries implementing the LDAP protocol and ASN.1 Basic Encoding Rules (BER) client software: ldapsearch, ldapadd, ldapdelete, and others Opensource LDAP server . OPENLDAP PHPLDAPADMIN PhpLdapAdmin is ued to mange the openldap server. It is simple and easy tool to mange openldap server. phpLDAPadmin (also known as PLA) is a web-based LDAP client. It provides easy, anywhere-accessible, multi-language administration for your LDAP server. Its hierarchical tree-viewer and advanced search functionality make it intuitive to browse and administer your LDAP directory. Since it is a web application, this LDAP browser works on many platforms, making your LDAP server easily manageable from any location. phpLDAPadmin is the perfect LDAP browser for the LDAP professional and novice alike. Its user base consists mostly of LDAP administration professionals. You might also like to see About. ldap adminsistration . PHPLDAPADMIN GroupOffice Group-Office is an enterprise CRM and groupware tool. Share projects, calendars, files and e-mail online with co-workers and clients. Easy to use and fully customizable. Its interfacea are userfriendly too. Copperoffice has used this CRM for its inbult webclient and for other groupware tools. It includes following features. Email Web client Calendar Address Book File sharing Tasks Notes NewsLetters GroupOffice CRM . GROUPOFFICE DOCKER Docker is a tool designed to make it easier to create, deploy, and run applications by using containers. Containers allow a developer to package up an application with all of the parts it needs, such as libraries and other dependencies, and ship it all out as one package. By doing so, thanks to the container, the developer can rest assured that the application will run on any other Linux machine regardless of any customized settings that machine might have that could differ from the machine used for writing and testing the code. In a way, Docker is a bit like a virtual machine. But unlike a virtual machine, rather than creating a whole virtual operating system, Docker allows applications to use the same Linux kernel as the system that they're running on and only requires applications be shipped with things not already running on the host computer. This gives a significant performance boost and reduces the size of the application. For copper email system also use docker due to it's toola are written in many languages and may wanted specific operating systems. Furthe system deployment is far more easy with docker. Copper has created their own images and hosted in docker.hub which may be pull from the hub when the system is deployed in user environments. Why docker . DOCKER Kubernetes Kubernetes is an open source container orchestration engine for automating deployment, scaling, and management of containerized applications. The open source project is hosted by the Cloud Native Computing Foundation (CNCF). Copper uses kubernetes for the system orchestration due to number of advantages available with the wolds leading orchestration platform. Kubernetes has a number of features. It can be thought of as: a container platform a microservices platform a portable cloud platform and a lot more. Kubernetes provides a container-centric management environment. It orchestrates computing, networking, and storage infrastructure on behalf of user workloads. This provides much of the simplicity of Platform as a Service (PaaS) with the flexibility of Infrastructure as a Service (IaaS), and enables portability across infrastructure providers. How Kubernetes is a platform Kuubernetes . KUBERNETES","title":"Features"},{"location":"Features/#features","text":"Copper Email Solution has been integrated many industry leading applicaitons to ensure most featurefull and secured email solution is delevered. Knowing each tool it was used will be good approach to know the solution well.","title":"Features"},{"location":"Features/#mta-mail-transfer-agent-postfix","text":"Postfix has been selected as the MTA in copper solution due to some of following advantages we found in postfix. To allow the server to send external emails, an MTA such as Sendmail, Postfix, or Exim is required. Mail is read either through direct access (shell login) or mailbox protocols like POP and IMAP. Postfix If you compare mail servers, then Postfix should be included, too, because it is also a popular mail server. It is a better mail server because it supports most of the current innovations in a modern-day mail server including but not limited to: \u2022 Virtual domains \u2022 SMTP relay \u2022 Consultation of SMTP client on its whitelist, grey list and blacklist databases \u2022 Host and user masquerading \u2022 Delivery to mailboxes with Maildir format As you compare mail servers, you will observe that Postfix utilises two large monolithic configuration files instead of the multiple task-oriented configuration files. You will then have to learn a single set of configuration file keywords. So we selected postfix considering It's popularity in integration projects and adaptability with new featues too. Simple SMTP server. POSTFIX .","title":"MTA (Mail Transfer Agent ) - POSTFIX"},{"location":"Features/#mda-mail-delevery-agent-dovecot","text":"Dovecot is an open source IMAP and POP3 email server for Linux/UNIX-like systems, written with security primarily in mind. Dovecot is an excellent choice for both small and large installations. It's fast, simple to set up, requires no special administration and it uses very little memory.","title":"MDA (Mail Delevery Agent) - DOVECOT"},{"location":"Features/#dovecot-advantages","text":"Best performing Standards compliant Clustered filesystems compatibilty Flexible authentification postfix and exim supprt for smtp authentication Security Flexible IMAP server. DOVECOT .","title":"Dovecot Advantages"},{"location":"Features/#spam-filter-rspamd","text":"Rspamd is an advanced spam filtering system that allows evaluation of messages by a number of rules including regular expressions, statistical analysis and custom services such as URL black lists. Each message is analysed by Rspamd and given a spam score. According to this spam score and the user\u2019s settings, Rspamd recommends an action for the MTA to apply to the message, for example, to pass, reject or add a header. Rspamd is designed to process hundreds of messages per second simultaneously, and provides a number of useful features. Here is the list of C modules available bundled with rspamd. chartable: checks character sets of text parts in messages. dkim: performs DKIM signatures checks. fuzzy_check: checks messages fuzzy hashes against public blacklists. spf: checks SPF records for messages processed. surbl: this module extracts URLs from messages and check them against public DNS black lists to filter messages with malicious URLs. regexp: the core module that allow to define regexp rules, rspamd internal functions and lua rules.","title":"SPAM FILTER - RSPAMD"},{"location":"Features/#lua-modules","text":"Lua modules are dynamically loaded on rspamd startup and are reloaded on rspamd reconfiguration. Should you want to write a lua module consult with the Lua API documentation. To define path to lua modules there is a special section named modules in rspamd: modules { path = /path/to/dir/ ; path = /path/to/module.lua ; path = $PLUGINSDIR/lua ; } If a path is a directory then rspamd scans it for `*.lua\u201d pattern and load all files matched. The following Lua modules are enabled in the default configuration (but may require additional configuration to work, see notes below): antivirus - integrates virus scanners (requires configuration) arc - checks and signs ARC signatures asn - looks up ASN-related information etc * * Fast, free and open-source spam filtering. RSPAMD Comparisson with other spam filters. SPAM FILTERS","title":"Lua modules"},{"location":"Features/#spf-sender-policy-framework","text":"Sender Policy Framework (SPF) is an email authentication method designed to detect forged sender addresses in emails (email spoofing), a technique often used in phishing and email spam. SPF allows the receiver to check that an email claiming to come from a specific domain comes from an IP address authorized by that domain's administrators. The list of authorized sending hosts and IP addresses for a domain is published in the DNS records for that domain. Authorize email senders with SPF Help prevent spoofing from your domain Set up SPF to prevent spammers from sending unauthorized emails from your domain. This type of spamming is called spoofing. Sender Policy Framework (SPF) is an email security method to prevent spoofing from your domain. Spoofing is a common unauthorized use of email, so some email servers require SPF. If you don't set up SPF for your domain, messages could bounce or could be marked as spam. Use SPF with DKIM and DMARC Along with SPF, we recommend setting up DomainKeys Identified Mail (DKIM) and Domain-based Message Authentication, Reporting Conformance (DMARC). SPF validates the domains that can send messages. DKIM verifies that message content is authentic and not changed. DMARC specifies how your domain handles suspicious emails that it gets.","title":"SPF - Sender Policy Framework"},{"location":"Features/#create-an-spf-record-for-your-domain","text":"An SPF record is a TXT record that lists the mail servers that are allowed to send email from your domain. Messages sent from a server that isn't the SPF record might be marked as spam. SPF originally used TXT records in DNS, which are supposed to be free-form text with no semantics attached. SPF proponents readily acknowledge that it would be better to have records specifically designated for SPF, but this choice was made to enable rapid implementation of SPF. In July 2005, IANA assigned the Resource Record type 99 to SPF. Later on, the use of SPF records was discontinued, and as of 2017, it is still necessary to use TXT records. Fast, free and open-source spam filtering. SPF Create TXT Record in DNS for SPF . TXT Record Creation","title":"Create an SPF record for your domain"},{"location":"Features/#dkim-domainkeys-identified-mail","text":"DomainKeys Identified Mail (DKIM) lets an organization take responsibility for a message that is in transit. The organization is a handler of the message, either as its originator or as an intermediary. Their reputation is the basis for evaluating whether to trust the message for further handling, such as delivery. Technically DKIM provides a method for validating a domain name identity that is associated with a message through cryptographic authentication. DKIM allows the receiver to check that an email claimed to have come from a specific domain was indeed authorized by the owner of that domain. It achieves this by affixing a digital signature, linked to a domain name, to each outgoing email message. The recipient system can verify this by looking up the sender's public key published in the DNS. A valid signature also guarantees that some parts of the email (possibly including attachments) have not been modified since the signature was affixed. Usually, DKIM signatures are not visible to end-users, and are affixed or verified by the infrastructure rather than the message's authors and recipients. DomainKeys Identified Mail . DKIM DKIM technical specification. DKIM SPECIFICATION","title":"DKIM - DomainKeys Identified Mail"},{"location":"Features/#dmark-domain-based-message-authentication-reporting-conformance","text":"DMARC, which stands for \u201cDomain-based Message Authentication, Reporting & Conformance\u201d, is an email authentication, policy, and reporting protocol. It builds on the widely deployed SPF and DKIM protocols, adding linkage to the author (\u201cFrom:\u201d) domain name, published policies for recipient handling of authentication failures, and reporting from receivers to senders, to improve and monitor protection of the domain from fraudulent email. DMARC is designed to fit into an organization\u2019s existing inbound email authentication process. The way it works is to help email receivers determine if the purported message \u201caligns\u201d with what the receiver knows about the sender. If not, DMARC includes guidance on how to handle the \u201cnon-aligned\u201d messages. For example, assuming that a receiver deploys SPF and DKIM, plus its own spam filters, the flow may look something like this: Domain-based Message Authentication, Reporting Conformance . DMARK","title":"DMARK - Domain-based Message Authentication, Reporting &amp; Conformance"},{"location":"Features/#openldap-","text":"Openldap is used as the userbase and email server domain configuration management portal. OpenLDAP is a free, open-source implementation of the Lightweight Directory Access Protocol (LDAP) developed by the OpenLDAP Project. It is released under its own BSD-style license called the OpenLDAP Public License. LDAP is a platform-independent protocol. Several common Linux distributions include OpenLDAP Software for LDAP support. The software also runs on BSD-variants, as well as AIX, Android, HP-UX, macOS, Solaris, Microsoft Windows (NT and derivatives, e.g. 2000, XP, Vista, Windows 7, etc.), and z/OS. OpenLDAP has three main components: slapd \u2013 stand-alone LDAP daemon and associated modules and tools libraries implementing the LDAP protocol and ASN.1 Basic Encoding Rules (BER) client software: ldapsearch, ldapadd, ldapdelete, and others Opensource LDAP server . OPENLDAP","title":"OPENLDAP -"},{"location":"Features/#phpldapadmin","text":"PhpLdapAdmin is ued to mange the openldap server. It is simple and easy tool to mange openldap server. phpLDAPadmin (also known as PLA) is a web-based LDAP client. It provides easy, anywhere-accessible, multi-language administration for your LDAP server. Its hierarchical tree-viewer and advanced search functionality make it intuitive to browse and administer your LDAP directory. Since it is a web application, this LDAP browser works on many platforms, making your LDAP server easily manageable from any location. phpLDAPadmin is the perfect LDAP browser for the LDAP professional and novice alike. Its user base consists mostly of LDAP administration professionals. You might also like to see About. ldap adminsistration . PHPLDAPADMIN","title":"PHPLDAPADMIN"},{"location":"Features/#groupoffice","text":"Group-Office is an enterprise CRM and groupware tool. Share projects, calendars, files and e-mail online with co-workers and clients. Easy to use and fully customizable. Its interfacea are userfriendly too. Copperoffice has used this CRM for its inbult webclient and for other groupware tools. It includes following features. Email Web client Calendar Address Book File sharing Tasks Notes NewsLetters GroupOffice CRM . GROUPOFFICE","title":"GroupOffice"},{"location":"Features/#docker","text":"Docker is a tool designed to make it easier to create, deploy, and run applications by using containers. Containers allow a developer to package up an application with all of the parts it needs, such as libraries and other dependencies, and ship it all out as one package. By doing so, thanks to the container, the developer can rest assured that the application will run on any other Linux machine regardless of any customized settings that machine might have that could differ from the machine used for writing and testing the code. In a way, Docker is a bit like a virtual machine. But unlike a virtual machine, rather than creating a whole virtual operating system, Docker allows applications to use the same Linux kernel as the system that they're running on and only requires applications be shipped with things not already running on the host computer. This gives a significant performance boost and reduces the size of the application. For copper email system also use docker due to it's toola are written in many languages and may wanted specific operating systems. Furthe system deployment is far more easy with docker. Copper has created their own images and hosted in docker.hub which may be pull from the hub when the system is deployed in user environments. Why docker . DOCKER","title":"DOCKER"},{"location":"Features/#kubernetes","text":"Kubernetes is an open source container orchestration engine for automating deployment, scaling, and management of containerized applications. The open source project is hosted by the Cloud Native Computing Foundation (CNCF). Copper uses kubernetes for the system orchestration due to number of advantages available with the wolds leading orchestration platform. Kubernetes has a number of features. It can be thought of as: a container platform a microservices platform a portable cloud platform and a lot more. Kubernetes provides a container-centric management environment. It orchestrates computing, networking, and storage infrastructure on behalf of user workloads. This provides much of the simplicity of Platform as a Service (PaaS) with the flexibility of Infrastructure as a Service (IaaS), and enables portability across infrastructure providers. How Kubernetes is a platform Kuubernetes . KUBERNETES","title":"Kubernetes"},{"location":"Hub/","text":"Copper Hub","title":"Central Supervision"},{"location":"Hub/#copper-hub","text":"","title":"Copper Hub"},{"location":"Installation/","text":"Installation Process Installation README.md file in the Deployment folder describe the installation process in detailed. It is the most updated one and please reffer it for more details. Clone this Repository $ git clone https://github.com/LSFLK/Copper.git Start the deployment $ cd Copper/copper-server/kubernetes/deployment/ $ sh deploy.sh You may have to provide following informaiton while the installation process is going on. Enter mysql database name: Ex : copper Enter mysql database password: Ex : copper Your domain must contain 3 parts. (Eg: part1.part2.part3) Enter the first part of domain: Ex : copper Enter the second part of domain: Ex : test Enter the third part of domain: Ex : lk Enter LDAP admin password: Ex : admin Enter LDAP readonly user name: Ex : raa Enter LDAP readonly user password: Ex : raa Enter organization name Ex : lsf Enter password for spam filter (RspamD) Ex : spam Ex : Image of running deply.sh Check kubernetes pods. Then system installation process will begin. It will not take much time to install the system. But it is must to check kubernetes pods whether to know system is installed successfully. All pods status must be \"Running\". $kubectl get pods -n copper Check kubernetes services. Further kubernetes services also should be checked. All LoadBalancers External IP should be \"localhost\" and all nodeport's External IP should be \" \". PORTs can be seen from bellow command and $kubectl get services -n copper ## Check kubernetes services. Some time it is required to uninstall the system. For that there is a shell script uninstall.sh $ sh undeploy.sh Ex : Image of running undeploy.sh","title":"Installation"},{"location":"Installation/#installation-process","text":"","title":"Installation Process"},{"location":"Installation/#installation","text":"README.md file in the Deployment folder describe the installation process in detailed. It is the most updated one and please reffer it for more details.","title":"Installation"},{"location":"Installation/#clone-this-repository","text":"$ git clone https://github.com/LSFLK/Copper.git","title":"Clone this Repository"},{"location":"Installation/#start-the-deployment","text":"$ cd Copper/copper-server/kubernetes/deployment/ $ sh deploy.sh","title":"Start the deployment"},{"location":"Installation/#you-may-have-to-provide-following-informaiton-while-the-installation-process-is-going-on","text":"Enter mysql database name: Ex : copper Enter mysql database password: Ex : copper Your domain must contain 3 parts. (Eg: part1.part2.part3) Enter the first part of domain: Ex : copper Enter the second part of domain: Ex : test Enter the third part of domain: Ex : lk Enter LDAP admin password: Ex : admin Enter LDAP readonly user name: Ex : raa Enter LDAP readonly user password: Ex : raa Enter organization name Ex : lsf Enter password for spam filter (RspamD) Ex : spam Ex : Image of running deply.sh","title":"You may have to provide following informaiton while the installation process is going on."},{"location":"Installation/#check-kubernetes-pods","text":"Then system installation process will begin. It will not take much time to install the system. But it is must to check kubernetes pods whether to know system is installed successfully. All pods status must be \"Running\". $kubectl get pods -n copper","title":"Check kubernetes pods."},{"location":"Installation/#check-kubernetes-services","text":"Further kubernetes services also should be checked. All LoadBalancers External IP should be \"localhost\" and all nodeport's External IP should be \" \". PORTs can be seen from bellow command and $kubectl get services -n copper ## Check kubernetes services. Some time it is required to uninstall the system. For that there is a shell script uninstall.sh $ sh undeploy.sh Ex : Image of running undeploy.sh","title":"Check kubernetes services."},{"location":"Overview/","text":"Overview Email is the most reliable official communication method in current coporate environments. But Most companies are not willing to host their servers in remote cloud servers due to security issues. Futher Its cost is also high. But maintaining their own email server is one of prime goal in companies IT units. Copper Email Solution Copper Email System is the solution developed by Lanka Software Foundation for those issues in the corporate sector. Obviously it is free and opensource. Its repositoty is open for any one to contribute. Further this solution is deployed over Kubernetes which is most advanced cloud server deplyment (Ochestration) framework in the world now. Lanka Software Foundation (LSF) Lanka Software Foundation (LSF) was established in 2003 as a company limited by guarantee and as \u201cnot for profit\u201d organization with the vision of positioning Sri Lanka as a \u201cglobal Free and Open Source (FOSS) Research Development hub\u201d. Refferences Copper main repository is it's github repository. For Github repository visit copper.github . Open source email solutions like : emailserver Mail solution with rspamd Tomav openLdap solutions RSPAMD Group office Groupware GroupOffice Contact us If you have any questions or doubts about Cu, please reach us via You can contact us","title":"Overview"},{"location":"Overview/#overview","text":"Email is the most reliable official communication method in current coporate environments. But Most companies are not willing to host their servers in remote cloud servers due to security issues. Futher Its cost is also high. But maintaining their own email server is one of prime goal in companies IT units.","title":"Overview"},{"location":"Overview/#copper-email-solution","text":"Copper Email System is the solution developed by Lanka Software Foundation for those issues in the corporate sector. Obviously it is free and opensource. Its repositoty is open for any one to contribute. Further this solution is deployed over Kubernetes which is most advanced cloud server deplyment (Ochestration) framework in the world now.","title":"Copper Email Solution"},{"location":"Overview/#lanka-software-foundation-lsf","text":"Lanka Software Foundation (LSF) was established in 2003 as a company limited by guarantee and as \u201cnot for profit\u201d organization with the vision of positioning Sri Lanka as a \u201cglobal Free and Open Source (FOSS) Research Development hub\u201d.","title":"Lanka Software Foundation (LSF)"},{"location":"Overview/#refferences","text":"Copper main repository is it's github repository. For Github repository visit copper.github . Open source email solutions like : emailserver Mail solution with rspamd Tomav openLdap solutions RSPAMD Group office Groupware GroupOffice","title":"Refferences"},{"location":"Overview/#contact-us","text":"If you have any questions or doubts about Cu, please reach us via You can contact us","title":"Contact us"},{"location":"Prerequisites/","text":"Prerequisites Host Requirment Following requirments must be satisfied by the Email solution host, vertual machine or cloud environment. RAM 2 GB HDD 50 GB Internet connectivity. Check Open Ports Make sure any other application does not use ports that we are going to listen to $ netstat -tulpn | grep -E -w 25|80|110|143|443|465|587|993|995|4190|11334 //check each port $ sudo lsof -i :25 Unblock following ports Service Software Protocol Port SMTP Postfix TCP 25 IMAP Dovecot TCP 143 SMTPS Postfix TCP 465 Submission Postfix TCP 587 IMAPS Dovecot TCP 993 Then check external firewall also . Docker It is must to have docker installed in your host machine. So first check whether docker is already available and docker version should be version 18.0 or greater. docker -v If docker has not already installed then it must be installed. Docker Installation Docker installation Since Ubuntu Server 16.04 is sans GUI, the installation and usage of Docker will be handled entirely through the command line. Before you run the installation command, make sure to update apt and then run any necessary upgrades. Do note, if your server\u2019s kernel upgrades, you\u2019ll need to reboot the system. Thus, you might want to plan to do this during a time when a server reboot is acceptable. To update apt, issue the command: sudo apt update Once that completes, upgrade with the command: sudo apt upgrade If the kernel upgrades, you\u2019ll want to reboot the server with the command: sudo reboot If the kernel doesn\u2019t upgrade, you\u2019re good to install Docker (without having to reboot). The Docker installation command is: sudo apt install docker.io If you\u2019re using a different Linux distribution, and you attempt to install (using your distribution\u2019s package manager of choice), only to find out docker.io isn\u2019t available, the package you want to install is called docker. For instance, the installation on Fedora would be: sudo dnf install docker If your distribution of choice is CentOS 7, installing docker is best handled via an installation script. First update the platform with the command sudo yum check-update. Once that completes, issue the following command to download and run the necessary script: curl -fsSL https://get.docker.com/ | sh Out of the box, the docker command can only be run with admin privileges. Because of security issues, you won\u2019t want to be working with Docker either from the root user or with the help of sudo. To get around this, you need to add your user to the docker group. This is done with the command: sudo usermod -a -G docker $USER Once you\u2019ve taken care of that, log out and back in, and you should be good to go. That is, unless your platform is Fedora. When adding a user to the docker group to this distribution, you\u2019ll find the group doesn\u2019t exist. What do you do? You create it first. Here are the commands to take care of this: sudo groupadd docker sudo gpasswd -a ${USER} docker sudo systemctl restart docker newgrp docker Log out and log back in. You should be ready to use Docker. Starting, stopping, and enabling Docker Once installed, you will want to enable the Docker daemon at boot. To do this, issue the following two commands: sudo systemctl start docker sudo systemctl enable docker Should you need to stop or restart the Docker daemon, the commands are: sudo systemctl stop docker sudo systemctl restart docker Docker is now ready to deploy containers. Kubernetes To deploy copper email solution we should have kubernetes version greater than 1.10 . Check kubernetes version kubectl version Now your system is ready for copper installation. kubernetes Installation Install kubernetes Install kubectl on Linux Install kubectl binary with curl on Linux Download the latest release with the command: curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl To download a specific version, replace the $(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt) portion of the command with the specific version. For example, to download version v1.14.0 on Linux, type: curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.14.0/bin/linux/amd64/kubectl Make the kubectl binary executable. chmod +x ./kubectl Move the binary in to your PATH. sudo mv ./kubectl /usr/local/bin/kubectl","title":"Prerequisites"},{"location":"Prerequisites/#prerequisites","text":"","title":"Prerequisites"},{"location":"Prerequisites/#host-requirment","text":"Following requirments must be satisfied by the Email solution host, vertual machine or cloud environment. RAM 2 GB HDD 50 GB Internet connectivity.","title":"Host Requirment"},{"location":"Prerequisites/#check-open-ports","text":"Make sure any other application does not use ports that we are going to listen to $ netstat -tulpn | grep -E -w 25|80|110|143|443|465|587|993|995|4190|11334 //check each port $ sudo lsof -i :25 Unblock following ports Service Software Protocol Port SMTP Postfix TCP 25 IMAP Dovecot TCP 143 SMTPS Postfix TCP 465 Submission Postfix TCP 587 IMAPS Dovecot TCP 993 Then check external firewall also .","title":"Check Open Ports"},{"location":"Prerequisites/#docker","text":"It is must to have docker installed in your host machine. So first check whether docker is already available and docker version should be version 18.0 or greater. docker -v If docker has not already installed then it must be installed.","title":"Docker"},{"location":"Prerequisites/#docker-installation","text":"Docker installation Since Ubuntu Server 16.04 is sans GUI, the installation and usage of Docker will be handled entirely through the command line. Before you run the installation command, make sure to update apt and then run any necessary upgrades. Do note, if your server\u2019s kernel upgrades, you\u2019ll need to reboot the system. Thus, you might want to plan to do this during a time when a server reboot is acceptable. To update apt, issue the command: sudo apt update Once that completes, upgrade with the command: sudo apt upgrade If the kernel upgrades, you\u2019ll want to reboot the server with the command: sudo reboot If the kernel doesn\u2019t upgrade, you\u2019re good to install Docker (without having to reboot). The Docker installation command is: sudo apt install docker.io If you\u2019re using a different Linux distribution, and you attempt to install (using your distribution\u2019s package manager of choice), only to find out docker.io isn\u2019t available, the package you want to install is called docker. For instance, the installation on Fedora would be: sudo dnf install docker If your distribution of choice is CentOS 7, installing docker is best handled via an installation script. First update the platform with the command sudo yum check-update. Once that completes, issue the following command to download and run the necessary script: curl -fsSL https://get.docker.com/ | sh Out of the box, the docker command can only be run with admin privileges. Because of security issues, you won\u2019t want to be working with Docker either from the root user or with the help of sudo. To get around this, you need to add your user to the docker group. This is done with the command: sudo usermod -a -G docker $USER Once you\u2019ve taken care of that, log out and back in, and you should be good to go. That is, unless your platform is Fedora. When adding a user to the docker group to this distribution, you\u2019ll find the group doesn\u2019t exist. What do you do? You create it first. Here are the commands to take care of this: sudo groupadd docker sudo gpasswd -a ${USER} docker sudo systemctl restart docker newgrp docker Log out and log back in. You should be ready to use Docker. Starting, stopping, and enabling Docker Once installed, you will want to enable the Docker daemon at boot. To do this, issue the following two commands: sudo systemctl start docker sudo systemctl enable docker Should you need to stop or restart the Docker daemon, the commands are: sudo systemctl stop docker sudo systemctl restart docker Docker is now ready to deploy containers.","title":"Docker Installation"},{"location":"Prerequisites/#kubernetes","text":"To deploy copper email solution we should have kubernetes version greater than 1.10 .","title":"Kubernetes"},{"location":"Prerequisites/#check-kubernetes-version","text":"kubectl version Now your system is ready for copper installation.","title":"Check kubernetes version"},{"location":"Prerequisites/#kubernetes-installation","text":"Install kubernetes Install kubectl on Linux Install kubectl binary with curl on Linux Download the latest release with the command: curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl To download a specific version, replace the $(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt) portion of the command with the specific version. For example, to download version v1.14.0 on Linux, type: curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.14.0/bin/linux/amd64/kubectl Make the kubectl binary executable. chmod +x ./kubectl Move the binary in to your PATH. sudo mv ./kubectl /usr/local/bin/kubectl","title":"kubernetes Installation"},{"location":"issues/","text":"Common issues for Email solutions Threats Eventhough the Email is one of the main communication model in the world now it has some information security issues too. Hear we just trying to high light them to grab your attention over those issue while you are operating any email solution. Spam Irrelevant or unsolicited(unrequested) messages sent over the Internet, typically to a large number of users, for the purposes of advertising, phishing, spreading malware, etc. Spoofing. Email spoofing is one of the best known spoofs. Since core SMTP fails to offer authentication, it is simple to forge and impersonate emails. Spoofed emails may request personal information and may appear to be from a known sender. Such emails request the recipient to reply with an account number for verification. The email spoofer then uses this account number for identity theft purposes, such as accessing the victim\u2019s bank account, changing contact details and so on.\u201d [https://www.techopedia.com/definition/5398/spoofing] Phishing The fraudulent practice of sending emails purporting(appear to be or do something, especially falsely.) to be from reputable companies in order to induce individuals to reveal personal information, such as passwords and credit card numbers. Malware software that is specifically designed to disrupt, damage, or gain unauthorized access to a computer system. Solutions Mail Filtering Mail Filtering is widely used to avoide spams and many tools are used to achive this target. DKIM and SPF are two of such mail filtering tools. Sender Policy Framework (SPF) is an email validation protocol designed to detect and block email spoofing by providing a mechanism to allow receiving mail exchangers to verify that incoming mail from a domain comes from an IP Address authorized by that domain\u2019s administrators. Transport encryption Transport encryption means that the email(s) will be encrypted when they are send (transferred) from one server to another. The emails are send through an encrypted tunnel when using this method. The emails are encrypted when the depart from one server and decrypted when the arrive on the other server. All emails on the server are not encrypted when they are stored on the server. Sending encrypted emails over the internet you would use for example the POP3S email transfer protocol with the Transport Layer Security (TLS)network protocol (which is the new name for the Secure Sockets Layer (SSL) protocol used for quite some years now).","title":"Email security"},{"location":"issues/#common-issues-for-email-solutions","text":"","title":"Common issues for Email solutions"},{"location":"issues/#threats","text":"Eventhough the Email is one of the main communication model in the world now it has some information security issues too. Hear we just trying to high light them to grab your attention over those issue while you are operating any email solution.","title":"Threats"},{"location":"issues/#spam","text":"Irrelevant or unsolicited(unrequested) messages sent over the Internet, typically to a large number of users, for the purposes of advertising, phishing, spreading malware, etc.","title":"Spam"},{"location":"issues/#spoofing","text":"Email spoofing is one of the best known spoofs. Since core SMTP fails to offer authentication, it is simple to forge and impersonate emails. Spoofed emails may request personal information and may appear to be from a known sender. Such emails request the recipient to reply with an account number for verification. The email spoofer then uses this account number for identity theft purposes, such as accessing the victim\u2019s bank account, changing contact details and so on.\u201d [https://www.techopedia.com/definition/5398/spoofing]","title":"Spoofing."},{"location":"issues/#phishing","text":"The fraudulent practice of sending emails purporting(appear to be or do something, especially falsely.) to be from reputable companies in order to induce individuals to reveal personal information, such as passwords and credit card numbers.","title":"Phishing"},{"location":"issues/#malware","text":"software that is specifically designed to disrupt, damage, or gain unauthorized access to a computer system.","title":"Malware"},{"location":"issues/#solutions","text":"","title":"Solutions"},{"location":"issues/#mail-filtering","text":"Mail Filtering is widely used to avoide spams and many tools are used to achive this target. DKIM and SPF are two of such mail filtering tools. Sender Policy Framework (SPF) is an email validation protocol designed to detect and block email spoofing by providing a mechanism to allow receiving mail exchangers to verify that incoming mail from a domain comes from an IP Address authorized by that domain\u2019s administrators.","title":"Mail Filtering"},{"location":"issues/#transport-encryption","text":"Transport encryption means that the email(s) will be encrypted when they are send (transferred) from one server to another. The emails are send through an encrypted tunnel when using this method. The emails are encrypted when the depart from one server and decrypted when the arrive on the other server. All emails on the server are not encrypted when they are stored on the server. Sending encrypted emails over the internet you would use for example the POP3S email transfer protocol with the Transport Layer Security (TLS)network protocol (which is the new name for the Secure Sockets Layer (SSL) protocol used for quite some years now).","title":"Transport encryption"},{"location":"troubleshoot/","text":"Troubleshoot Troubleshooting and debugging is very imporatn in any complex IT solution. Hear in copper there are few critical points which is requied special attention in any case of technical issue. Basically copper solution consists with 5 major components . Email server, Openldap server, Group Office web client, Phpldapadmin and mysql databae. But Trouble shooting is mostly requied for emailserver and openldap server. So it is requied to know the trouble shooting points of these two containers. Testing Postfix Check the service is running service postfix status Check the configuration postconf -n Check the log more /var/log/mail.log more /var/log/mail.err Change postfix configuration file and reload the configuration. postfix reload postfix/postfix-script: refreshing the Postfix mail system Enable/Disable plaintext Authentication for SMTP Please comment out lines below in Postfix config file /etc/postfix/main.cf and reload or restart Postfix service: smtpd_sasl_auth_enable = yes smtpd_sasl_security_options = noanonymous force all clients to use secure connection through port 25 smtpd_tls_auth_only=yes Test mail sending with port 25 (plaintext authenticaiton) Suppose your emailserver is in the localhost wso2s-MacBook-Pro:docker wso2$ telnet localhost 25 Trying ::1\u2026 telnet: connect to address ::1: Connection refused Trying 127.0.0.1\u2026 Connected to localhost. Escape character is \u2018^]\u2019. 220 mail.lsf.cu.lk ESMTP Postfix (Ubuntu) EHLO localhost 250-mail.lsf.cu.lk 250-PIPELINING 250-SIZE 10240000 250-VRFY 250-ETRN 250-STARTTLS 250-ENHANCEDSTATUSCODES 250\u20138BITMIME 250-DSN 250 SMTPUTF8 MAIL FROM:info@lsf.cu.lk 250 2.1.0 Ok data 554 5.5.1 Error: no valid recipients subject:hello 221 2.7.0 Error: I can break rules, too. Goodbye. Connection closed by foreign host. wso2s-MacBook-Pro:docker wso2$ telnet localhost 25 Trying ::1\u2026 telnet: connect to address ::1: Connection refused Trying 127.0.0.1\u2026 Connected to localhost. Escape character is \u2018^]\u2019. 220 mail.lsf.cu.lk ESMTP Postfix (Ubuntu) MAIL FROM:dadmin@lsf.cu.lk 250 2.1.0 Ok RCPT TO:info@lsf.cu.lk 250 2.1.5 Ok data 354 End data with CR LF . CR LF subject:hello body:hello . 250 2.0.0 Ok: queued as DBE312003D5 421 4.4.2 mail.lsf.cu.lk Error: timeout exceeded Connection closed by foreign host. wso2s-MacBook-Pro:docker wso2$ Test send mail with TLS (587 port) Even though it is possible to send messages using port 25 configuration, it is not possible to send email with TLS activated port 587. Then you have to check email server connection with TLS. You should have installed openssl tool. root@email-b6c7d4c7f-5t87l:/var/log# openssl s_client -connect email:587 -starttls smtp CONNECTED(00000003) depth=0 C = US, ST = Oregon, L = Portland, O = lsf, OU = Org, CN = mail.copper.test.lk verify error:num=18:self signed certificate verify return:1 depth=0 C = US, ST = Oregon, L = Portland, O = lsf, OU = Org, CN = mail.copper.test.lk verify return:1 --- Certificate chain 0 s:/C=US/ST=Oregon/L=Portland/O=lsf/OU=Org/CN=mail.copper.test.lk i:/C=US/ST=Oregon/L=Portland/O=lsf/OU=Org/CN=mail.copper.test.lk --- Server certificate -----BEGIN CERTIFICATE----- MIIFrDCCA5SgAwIBAgIJAN+f6wFnoARaMA0GCSqGSIb3DQEBCwUAMGsxCzAJBgNV 1kcNTDFiDeY0F8m/L4C9wUyYA5Ebi5tJGc/Gz4AcAFcgF1Kxt9I3//rQl8Kp0X6D djw8jiiXJMI82MGgUvJqYvYzAXwYin7aed+7PDkbC7hljlnJXEsnAMBROvQ++zHX 1dAf5AxeMj+YDFm6kiX/lg== -----END CERTIFICATE----- subject=/C=US/ST=Oregon/L=Portland/O=lsf/OU=Org/CN=mail.copper.test.lk issuer=/C=US/ST=Oregon/L=Portland/O=lsf/OU=Org/CN=mail.copper.test.lk --- No client certificate CA names sent Peer signing digest: SHA512 Server Temp Key: X25519, 253 bits --- SSL handshake has read 2559 bytes and written 302 bytes Verification error: self signed certificate --- New, TLSv1.2, Cipher is ECDHE-RSA-AES256-GCM-SHA384 Server public key is 4096 bit Secure Renegotiation IS supported Compression: NONE Expansion: NONE No ALPN negotiated SSL-Session: Protocol : TLSv1.2 Cipher : ECDHE-RSA-AES256-GCM-SHA384 Session-ID: 971757A8240C0495552B360CCFACF8A2FBF00411A5B30605100F19E54D1722E9 Session-ID-ctx: Master-Key: 9380516DC2C86E8E67EABDB62A256DBEE2290A24D515646008C854DB737BB2AEA3C62E35AC6C484EB5A71814B1ED8AC4 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - 5e 8b 3a 7a 5f 7f 2f 21-9a 8c e4 44 0f 08 28 dd ^.:z_./!...D..(. 0010 - bb fe 97 6d b8 04 2f 6c-4e 4a d9 86 b5 34 8e ee ...m../lNJ...4.. 0020 - 86 df f3 f8 b4 98 9d 67-62 00 54 94 59 57 ad 48 .......gb.T.YW.H 0030 - 58 50 d8 66 72 c3 04 e7-cb 8e 74 0a db da e6 9b XP.fr.....t..... 0040 - 06 d6 d3 db f2 6e f0 32-e0 a0 18 a0 d4 db d6 f1 .....n.2........ 0050 - 4d 97 fc 51 03 2e bb 20-1e 52 4e c6 41 34 38 32 M..Q... .RN.A482 0060 - fb d9 7a 8d 01 af a5 45-5c 69 9a 93 87 fc af 27 ..z....E\\i..... 0070 - e1 97 0b 77 f1 04 dd 15-65 15 3a 0a d3 dd bb 3c ...w....e.:.... 0080 - 5f de a4 23 4b 3e 4b 2a-d0 41 12 f4 04 83 7c 3b _..#K K*.A....|; 0090 - a0 51 11 2b 71 69 a5 d1-f8 b6 26 51 2e fe 2b 1c .Q.+qi.... Q..+. 00a0 - 84 e9 6c 74 59 4c 46 11-a5 a9 fe c0 f1 b4 b2 46 ..ltYLF........F Start Time: 1553159047 Timeout : 7200 (sec) Verify return code: 18 (self signed certificate) Extended master secret: yes --- 250 SMTPUTF8 mail from:test@copper.test.lk 250 2.1.0 Ok rcpt to:test@copper.test.lk 554 5.7.1 unknown[10.1.0.1] : Client host rejected: Access denied quit 221 2.0.0 Bye closed root@email-b6c7d4c7f-5t87l:/var/log# Step 2 Check the submission port. grep submission /etc/services Step 3 Check the postfix log file Mar 21 08:47:22 email-b6c7d4c7f-5t87l postfix/submission/smtpd[395]: connect from unknown[10.1.7.188] Mar 21 08:47:22 email-b6c7d4c7f-5t87l postfix/submission/smtpd[395]: NOQUEUE: reject: RCPT from unknown[10.1.7.188]: 554 5.7.1 unknown[10.1.7.188] : Client host rejected: Access denied; from= test@copper.test.lk to= test@copper.test.lk proto=ESMTP helo= localhost Mar 21 08:47:22 email-b6c7d4c7f-5t87l postfix/submission/smtpd[395]: disconnect from unknown[10.1.7.188] ehlo=2 starttls=1 mail=1 rcpt=0/1 data=0/1 quit=1 commands=5/7 Mar 21 08:50:42 email-b6c7d4c7f-5t87l postfix/anvil[398]: statistics: max connection rate 1/60s for (submission:10.1.7.188) at Mar 21 08:47:22 Mar 21 08:50:42 email-b6c7d4c7f-5t87l postfix/anvil[398]: statistics: max connection count 1 for (submission:10.1.7.188) at Mar 21 08:47:22 Mar 21 08:50:42 email-b6c7d4c7f-5t87l postfix/anvil[398]: statistics: max cache size 1 at Mar 21 08:47:22 Step 4 check the dovecot log file Mar 21 08:48:28 imap-login: Info: Login: user= test , method=PLAIN, rip=10.1.7.188, lip=10.1.7.185, mpid=404, TLS, session= pX9RzZaECtYKAQe8 Mar 21 08:48:28 imap(test): Info: Logged out in=54 out=768 Mar 21 08:50:02 auth: Error: ldap_unbind Mar 21 08:50:02 auth: Error: ldap_free_connection 1 1 Mar 21 08:50:02 auth: Error: ldap_send_unbind Mar 21 08:50:02 auth: Error: ldap_free_connection: actually freed Step 5 According to observation looks like postfix has rejected client requests when comes from the port 587. Then checked the submission has enabled in master.cf file. It should have following configuration. submission inet n - n - - smtpd -o syslog_name=postfix/submission -o smtpd_tls_security_level=encrypt -o smtpd_sasl_auth_enable=yes -o smtpd_client_restrictions=permit_sasl_authenticated,reject -o milter_macro_daemon_name=ORIGINATING Step 5 Now checked mail sending with port number 25. openssl s_client -connect email:25 -starttls smtp 0090 - a1 d2 a7 4d e8 ed 1f 79-b7 8c ba a9 a3 0f 7a 2c ...M...y......z, 00a0 - 67 2b af f8 44 fc 61 c2-7f a9 7f 79 af fa e7 g+..D.a....y... 00b0 - SPACES/NULS Start Time: 1553160437 Timeout : 7200 (sec) Verify return code: 18 (self signed certificate) Extended master secret: yes --- 250 SMTPUTF8 mail from:test@copper.test.lk 250 2.1.0 Ok rcpt to:test@copper.test.lk 250 2.1.5 Ok data 354 End data with CR LF . CR LF subject:Test from 25 body:test form 25 . 250 2.0.0 Ok: queued as A8C1C3812E0 It was also success. Then it is clear issue comes only when sending mail using port number 587. check the submission port grep submission /etc/services Email related issues and solutions. https://support.plesk.com/hc/en-us/sections/115000422433-Mail Testing dovecot check dovecot version dovecot\u200a\u2014\u200aversion 2.2.22 (fe789d2) check the active configuration doveconf -n Check dovecot log files more /var/log/dovecot.log Check dovecot service is running service dovecot status Disable/Enable plaintext unencripted authentication for DOVECOT If you want to enable POP3/IMAP services without STARTTLS for some reason (again, not recommended), please update below two parameters in Dovecot config file /etc/dovecot/dovecot.conf and restart Dovecot service: on Linux and OpenBSD, it\u2019s /etc/dovecot/dovecot.conf on FreeBSD, it\u2019s /usr/local/etc/dovecot/dovecot.conf disable_plaintext_auth=no ssl=yes Again, it\u2019s strongly recommended to use only POP3S/IMAPS for better security. disable_plaintext_auth=yes ssl=required Test by telnet Telnet IP address of Client Access Server (Exchange) Port # 143 . if connection not established check ports check 10-main.conf file whether 143 open for imap check dovcot.conf wether listn ipv4 Check user validaiton with dovecot imap server root@mail:/var/log# doveadm user thara@coppermail.dyndns.org field valuedoveadm(thara@coppermail.dyndns.org): Error: user thara@coppermail.dyndns.org: Auth USER lookup failed * then check configurations 10-auth.conf and Test imap server (dovecot) with telnet root@mail:/etc/dovecot/conf.d# telnet localhost 143 Trying 127.0.0.1\u2026 Connected to localhost. Escape character is \u2018^]\u2019. * OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE AUTH=PLAIN AUTH=LOGIN] Dovecot ready. 01 login thara@coppermail.dyndns.org postfix@123 01 OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE SORT SORT=DISPLAY THREAD=REFERENCES THREAD=REFS THREAD=ORDEREDSUBJECT MULTIAPPEND URL-PARTIAL CATENATE UNSELECT CHILDREN NAMESPACE UIDPLUS LIST-EXTENDED I18NLEVEL=1 CONDSTORE QRESYNC ESEARCH ESORT SEARCHRES WITHIN CONTEXT=SEARCH LIST-STATUS BINARY MOVE QUOTA] Logged in . list \u201c\u201d \u201c*\u201d * LIST (\\HasNoChildren \\Drafts) \u201c.\u201d Drafts * LIST (\\HasNoChildren \\Junk) \u201c.\u201d Junk * LIST (\\HasNoChildren \\Sent) \u201c.\u201d Sent * LIST (\\HasNoChildren \\Trash) \u201c.\u201d Trash * LIST (\\HasNoChildren \\Junk) \u201c.\u201d Spam * LIST (\\HasNoChildren \\Archive) \u201c.\u201d Archive * LIST (\\HasNoChildren) \u201c.\u201d INBOX . OK List completed (0.001 + 0.000 secs). ? select inbox * FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft) * OK [PERMANENTFLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft \\*)] Flags permitted. * 0 EXISTS * 0 RECENT * OK [UIDVALIDITY 1528974656] UIDs valid * OK [UIDNEXT 1] Predicted next UID ? OK [READ-WRITE] Select completed (0.008 + 0.000 + 0.007 secs). ?fetch 1 body[text] ?fetch BAD Error in IMAP command 1: Unknown command (4261338.063 + 0.000 secs). ?fetch 1 header[text] ?fetch BAD Error in IMAP command 1: Unknown command (4261381.185 + 0.000 secs). ? logout * BYE Logging out ? OK Logout completed (0.001 + 0.000 secs). Connection closed by foreign host. Testing openldap server Testing ldap server connectivity. The OpenLDAP tools require that you specify an authentication method and a server location for each operation. To specify the server, use the -H flag followed by the protocol and network location of the server in question. For basic, unencrypted communication, the protocol scheme will be ldap:// like this: ldapsearch -H ldap://server_domain_or_IP . . . If you are communicating with a local server, you can leave off the server domain name or IP address (you still need to specify the scheme). Use ldif file for changing/updating the openldap server It is possible to update or change openldap server from command line as explain bellow. For example how to add organizational unit using sample.ldif. sample.ldif : dn: ou=users,dc=coppermail,dc=dyndns,dc=org changetype: add objectClass: organizationalUnit objectclass: top ou: users Command to insert a organization unit from coammand line. ldapmodify -H ldap:// -x -D \u201ccn=admin,dc=coppermail,dc=dyndns,dc=org\u201d -w 12345 -f sample.ldif Test the openLDAP server ldapwhoami -H ldap:// -x above command will check openldap server communication with unsecured parth. You should now be able to upgrade your connections to use STARTTLS by passing the -Z option when using the OpenLDAP utilities. You can force STARTTLS upgrade by passing it twice. Test this by typing: ldapwhoami -H ldap:// -x -ZZ This forces a STARTTLS upgrade. If this is successful, you should see: STARTTLS success anonymous If you mis-configured something, you will likely see an error like this: STARTTLS failure ldap_start_tls: Connect error (-11) additional info: (unknown error code) Advanced TLS - ldap testing Command \u201cldapsearch\u201d with debug level 5, it seems succeed in Executing START TLS, and the ldap server\u2019s certificate is valid,but it shows some other strange errors: ldapsearch -ZZ -d 5 If you want to troubleshoot whole TLS communication with ldap server step by step use bellow coammand. ldapsearch -x -ZZ -d1 Database Testing Now a groupoffice database should be created preor to start groupoffice installation begins. first you have to check what is the pod name of dataase. #kubectl get pods -n monitoring Then exicute followng command to open a mysql client connected with the mysql pod. #kubectl run -it --rm --image=mysql:5.6 --restart=Never mysql-client -n monitoring -- mysql -h mysql -pc0pperDB Then you will get access to the mysql database. Once you connected check databae. SHOW DATABASES; USE copper; SHOW TABLES;","title":"Troubleshoot"},{"location":"troubleshoot/#troubleshoot","text":"Troubleshooting and debugging is very imporatn in any complex IT solution. Hear in copper there are few critical points which is requied special attention in any case of technical issue. Basically copper solution consists with 5 major components . Email server, Openldap server, Group Office web client, Phpldapadmin and mysql databae. But Trouble shooting is mostly requied for emailserver and openldap server. So it is requied to know the trouble shooting points of these two containers.","title":"Troubleshoot"},{"location":"troubleshoot/#testing-postfix","text":"Check the service is running service postfix status Check the configuration postconf -n Check the log more /var/log/mail.log more /var/log/mail.err Change postfix configuration file and reload the configuration. postfix reload postfix/postfix-script: refreshing the Postfix mail system","title":"Testing Postfix"},{"location":"troubleshoot/#enabledisable-plaintext-authentication-for-smtp","text":"Please comment out lines below in Postfix config file /etc/postfix/main.cf and reload or restart Postfix service: smtpd_sasl_auth_enable = yes smtpd_sasl_security_options = noanonymous force all clients to use secure connection through port 25 smtpd_tls_auth_only=yes","title":"Enable/Disable plaintext Authentication for SMTP"},{"location":"troubleshoot/#test-mail-sending-with-port-25-plaintext-authenticaiton","text":"Suppose your emailserver is in the localhost wso2s-MacBook-Pro:docker wso2$ telnet localhost 25 Trying ::1\u2026 telnet: connect to address ::1: Connection refused Trying 127.0.0.1\u2026 Connected to localhost. Escape character is \u2018^]\u2019. 220 mail.lsf.cu.lk ESMTP Postfix (Ubuntu) EHLO localhost 250-mail.lsf.cu.lk 250-PIPELINING 250-SIZE 10240000 250-VRFY 250-ETRN 250-STARTTLS 250-ENHANCEDSTATUSCODES 250\u20138BITMIME 250-DSN 250 SMTPUTF8 MAIL FROM:info@lsf.cu.lk 250 2.1.0 Ok data 554 5.5.1 Error: no valid recipients subject:hello 221 2.7.0 Error: I can break rules, too. Goodbye. Connection closed by foreign host. wso2s-MacBook-Pro:docker wso2$ telnet localhost 25 Trying ::1\u2026 telnet: connect to address ::1: Connection refused Trying 127.0.0.1\u2026 Connected to localhost. Escape character is \u2018^]\u2019. 220 mail.lsf.cu.lk ESMTP Postfix (Ubuntu) MAIL FROM:dadmin@lsf.cu.lk 250 2.1.0 Ok RCPT TO:info@lsf.cu.lk 250 2.1.5 Ok data 354 End data with CR LF . CR LF subject:hello body:hello . 250 2.0.0 Ok: queued as DBE312003D5 421 4.4.2 mail.lsf.cu.lk Error: timeout exceeded Connection closed by foreign host. wso2s-MacBook-Pro:docker wso2$","title":"Test mail sending with port 25 (plaintext authenticaiton)"},{"location":"troubleshoot/#test-send-mail-with-tls-587-port","text":"Even though it is possible to send messages using port 25 configuration, it is not possible to send email with TLS activated port 587. Then you have to check email server connection with TLS. You should have installed openssl tool. root@email-b6c7d4c7f-5t87l:/var/log# openssl s_client -connect email:587 -starttls smtp CONNECTED(00000003) depth=0 C = US, ST = Oregon, L = Portland, O = lsf, OU = Org, CN = mail.copper.test.lk verify error:num=18:self signed certificate verify return:1 depth=0 C = US, ST = Oregon, L = Portland, O = lsf, OU = Org, CN = mail.copper.test.lk verify return:1 --- Certificate chain 0 s:/C=US/ST=Oregon/L=Portland/O=lsf/OU=Org/CN=mail.copper.test.lk i:/C=US/ST=Oregon/L=Portland/O=lsf/OU=Org/CN=mail.copper.test.lk --- Server certificate -----BEGIN CERTIFICATE----- MIIFrDCCA5SgAwIBAgIJAN+f6wFnoARaMA0GCSqGSIb3DQEBCwUAMGsxCzAJBgNV 1kcNTDFiDeY0F8m/L4C9wUyYA5Ebi5tJGc/Gz4AcAFcgF1Kxt9I3//rQl8Kp0X6D djw8jiiXJMI82MGgUvJqYvYzAXwYin7aed+7PDkbC7hljlnJXEsnAMBROvQ++zHX 1dAf5AxeMj+YDFm6kiX/lg== -----END CERTIFICATE----- subject=/C=US/ST=Oregon/L=Portland/O=lsf/OU=Org/CN=mail.copper.test.lk issuer=/C=US/ST=Oregon/L=Portland/O=lsf/OU=Org/CN=mail.copper.test.lk --- No client certificate CA names sent Peer signing digest: SHA512 Server Temp Key: X25519, 253 bits --- SSL handshake has read 2559 bytes and written 302 bytes Verification error: self signed certificate --- New, TLSv1.2, Cipher is ECDHE-RSA-AES256-GCM-SHA384 Server public key is 4096 bit Secure Renegotiation IS supported Compression: NONE Expansion: NONE No ALPN negotiated SSL-Session: Protocol : TLSv1.2 Cipher : ECDHE-RSA-AES256-GCM-SHA384 Session-ID: 971757A8240C0495552B360CCFACF8A2FBF00411A5B30605100F19E54D1722E9 Session-ID-ctx: Master-Key: 9380516DC2C86E8E67EABDB62A256DBEE2290A24D515646008C854DB737BB2AEA3C62E35AC6C484EB5A71814B1ED8AC4 PSK identity: None PSK identity hint: None SRP username: None TLS session ticket lifetime hint: 7200 (seconds) TLS session ticket: 0000 - 5e 8b 3a 7a 5f 7f 2f 21-9a 8c e4 44 0f 08 28 dd ^.:z_./!...D..(. 0010 - bb fe 97 6d b8 04 2f 6c-4e 4a d9 86 b5 34 8e ee ...m../lNJ...4.. 0020 - 86 df f3 f8 b4 98 9d 67-62 00 54 94 59 57 ad 48 .......gb.T.YW.H 0030 - 58 50 d8 66 72 c3 04 e7-cb 8e 74 0a db da e6 9b XP.fr.....t..... 0040 - 06 d6 d3 db f2 6e f0 32-e0 a0 18 a0 d4 db d6 f1 .....n.2........ 0050 - 4d 97 fc 51 03 2e bb 20-1e 52 4e c6 41 34 38 32 M..Q... .RN.A482 0060 - fb d9 7a 8d 01 af a5 45-5c 69 9a 93 87 fc af 27 ..z....E\\i..... 0070 - e1 97 0b 77 f1 04 dd 15-65 15 3a 0a d3 dd bb 3c ...w....e.:.... 0080 - 5f de a4 23 4b 3e 4b 2a-d0 41 12 f4 04 83 7c 3b _..#K K*.A....|; 0090 - a0 51 11 2b 71 69 a5 d1-f8 b6 26 51 2e fe 2b 1c .Q.+qi.... Q..+. 00a0 - 84 e9 6c 74 59 4c 46 11-a5 a9 fe c0 f1 b4 b2 46 ..ltYLF........F Start Time: 1553159047 Timeout : 7200 (sec) Verify return code: 18 (self signed certificate) Extended master secret: yes --- 250 SMTPUTF8 mail from:test@copper.test.lk 250 2.1.0 Ok rcpt to:test@copper.test.lk 554 5.7.1 unknown[10.1.0.1] : Client host rejected: Access denied quit 221 2.0.0 Bye closed root@email-b6c7d4c7f-5t87l:/var/log#","title":"Test send mail with TLS (587 port)"},{"location":"troubleshoot/#step-2-check-the-submission-port","text":"grep submission /etc/services","title":"Step 2 Check the submission port."},{"location":"troubleshoot/#step-3-check-the-postfix-log-file","text":"Mar 21 08:47:22 email-b6c7d4c7f-5t87l postfix/submission/smtpd[395]: connect from unknown[10.1.7.188] Mar 21 08:47:22 email-b6c7d4c7f-5t87l postfix/submission/smtpd[395]: NOQUEUE: reject: RCPT from unknown[10.1.7.188]: 554 5.7.1 unknown[10.1.7.188] : Client host rejected: Access denied; from= test@copper.test.lk to= test@copper.test.lk proto=ESMTP helo= localhost Mar 21 08:47:22 email-b6c7d4c7f-5t87l postfix/submission/smtpd[395]: disconnect from unknown[10.1.7.188] ehlo=2 starttls=1 mail=1 rcpt=0/1 data=0/1 quit=1 commands=5/7 Mar 21 08:50:42 email-b6c7d4c7f-5t87l postfix/anvil[398]: statistics: max connection rate 1/60s for (submission:10.1.7.188) at Mar 21 08:47:22 Mar 21 08:50:42 email-b6c7d4c7f-5t87l postfix/anvil[398]: statistics: max connection count 1 for (submission:10.1.7.188) at Mar 21 08:47:22 Mar 21 08:50:42 email-b6c7d4c7f-5t87l postfix/anvil[398]: statistics: max cache size 1 at Mar 21 08:47:22","title":"Step 3 Check the postfix log file"},{"location":"troubleshoot/#step-4-check-the-dovecot-log-file","text":"Mar 21 08:48:28 imap-login: Info: Login: user= test , method=PLAIN, rip=10.1.7.188, lip=10.1.7.185, mpid=404, TLS, session= pX9RzZaECtYKAQe8 Mar 21 08:48:28 imap(test): Info: Logged out in=54 out=768 Mar 21 08:50:02 auth: Error: ldap_unbind Mar 21 08:50:02 auth: Error: ldap_free_connection 1 1 Mar 21 08:50:02 auth: Error: ldap_send_unbind Mar 21 08:50:02 auth: Error: ldap_free_connection: actually freed","title":"Step 4 check the dovecot log file"},{"location":"troubleshoot/#step-5","text":"According to observation looks like postfix has rejected client requests when comes from the port 587. Then checked the submission has enabled in master.cf file. It should have following configuration. submission inet n - n - - smtpd -o syslog_name=postfix/submission -o smtpd_tls_security_level=encrypt -o smtpd_sasl_auth_enable=yes -o smtpd_client_restrictions=permit_sasl_authenticated,reject -o milter_macro_daemon_name=ORIGINATING","title":"Step 5"},{"location":"troubleshoot/#step-5_1","text":"Now checked mail sending with port number 25. openssl s_client -connect email:25 -starttls smtp 0090 - a1 d2 a7 4d e8 ed 1f 79-b7 8c ba a9 a3 0f 7a 2c ...M...y......z, 00a0 - 67 2b af f8 44 fc 61 c2-7f a9 7f 79 af fa e7 g+..D.a....y... 00b0 - SPACES/NULS Start Time: 1553160437 Timeout : 7200 (sec) Verify return code: 18 (self signed certificate) Extended master secret: yes --- 250 SMTPUTF8 mail from:test@copper.test.lk 250 2.1.0 Ok rcpt to:test@copper.test.lk 250 2.1.5 Ok data 354 End data with CR LF . CR LF subject:Test from 25 body:test form 25 . 250 2.0.0 Ok: queued as A8C1C3812E0 It was also success. Then it is clear issue comes only when sending mail using port number 587.","title":"Step 5"},{"location":"troubleshoot/#check-the-submission-port","text":"grep submission /etc/services","title":"check the submission port"},{"location":"troubleshoot/#email-related-issues-and-solutions","text":"https://support.plesk.com/hc/en-us/sections/115000422433-Mail","title":"Email related issues and solutions."},{"location":"troubleshoot/#testing-dovecot","text":"check dovecot version dovecot\u200a\u2014\u200aversion 2.2.22 (fe789d2) check the active configuration doveconf -n Check dovecot log files more /var/log/dovecot.log Check dovecot service is running service dovecot status","title":"Testing dovecot"},{"location":"troubleshoot/#disableenable-plaintext-unencripted-authentication-for-dovecot","text":"If you want to enable POP3/IMAP services without STARTTLS for some reason (again, not recommended), please update below two parameters in Dovecot config file /etc/dovecot/dovecot.conf and restart Dovecot service: on Linux and OpenBSD, it\u2019s /etc/dovecot/dovecot.conf on FreeBSD, it\u2019s /usr/local/etc/dovecot/dovecot.conf disable_plaintext_auth=no ssl=yes Again, it\u2019s strongly recommended to use only POP3S/IMAPS for better security. disable_plaintext_auth=yes ssl=required Test by telnet Telnet IP address of Client Access Server (Exchange) Port # 143 . if connection not established check ports check 10-main.conf file whether 143 open for imap check dovcot.conf wether listn ipv4","title":"Disable/Enable plaintext unencripted authentication for DOVECOT"},{"location":"troubleshoot/#check-user-validaiton-with-dovecot-imap-server","text":"root@mail:/var/log# doveadm user thara@coppermail.dyndns.org field valuedoveadm(thara@coppermail.dyndns.org): Error: user thara@coppermail.dyndns.org: Auth USER lookup failed * then check configurations 10-auth.conf and","title":"Check user validaiton with dovecot imap server"},{"location":"troubleshoot/#test-imap-server-dovecot-with-telnet","text":"root@mail:/etc/dovecot/conf.d# telnet localhost 143 Trying 127.0.0.1\u2026 Connected to localhost. Escape character is \u2018^]\u2019. * OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE AUTH=PLAIN AUTH=LOGIN] Dovecot ready. 01 login thara@coppermail.dyndns.org postfix@123 01 OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE SORT SORT=DISPLAY THREAD=REFERENCES THREAD=REFS THREAD=ORDEREDSUBJECT MULTIAPPEND URL-PARTIAL CATENATE UNSELECT CHILDREN NAMESPACE UIDPLUS LIST-EXTENDED I18NLEVEL=1 CONDSTORE QRESYNC ESEARCH ESORT SEARCHRES WITHIN CONTEXT=SEARCH LIST-STATUS BINARY MOVE QUOTA] Logged in . list \u201c\u201d \u201c*\u201d * LIST (\\HasNoChildren \\Drafts) \u201c.\u201d Drafts * LIST (\\HasNoChildren \\Junk) \u201c.\u201d Junk * LIST (\\HasNoChildren \\Sent) \u201c.\u201d Sent * LIST (\\HasNoChildren \\Trash) \u201c.\u201d Trash * LIST (\\HasNoChildren \\Junk) \u201c.\u201d Spam * LIST (\\HasNoChildren \\Archive) \u201c.\u201d Archive * LIST (\\HasNoChildren) \u201c.\u201d INBOX . OK List completed (0.001 + 0.000 secs). ? select inbox * FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft) * OK [PERMANENTFLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft \\*)] Flags permitted. * 0 EXISTS * 0 RECENT * OK [UIDVALIDITY 1528974656] UIDs valid * OK [UIDNEXT 1] Predicted next UID ? OK [READ-WRITE] Select completed (0.008 + 0.000 + 0.007 secs). ?fetch 1 body[text] ?fetch BAD Error in IMAP command 1: Unknown command (4261338.063 + 0.000 secs). ?fetch 1 header[text] ?fetch BAD Error in IMAP command 1: Unknown command (4261381.185 + 0.000 secs). ? logout * BYE Logging out ? OK Logout completed (0.001 + 0.000 secs). Connection closed by foreign host.","title":"Test imap server (dovecot) with telnet"},{"location":"troubleshoot/#testing-openldap-server","text":"","title":"Testing openldap server"},{"location":"troubleshoot/#testing-ldap-server-connectivity","text":"The OpenLDAP tools require that you specify an authentication method and a server location for each operation. To specify the server, use the -H flag followed by the protocol and network location of the server in question. For basic, unencrypted communication, the protocol scheme will be ldap:// like this: ldapsearch -H ldap://server_domain_or_IP . . . If you are communicating with a local server, you can leave off the server domain name or IP address (you still need to specify the scheme).","title":"Testing ldap server connectivity."},{"location":"troubleshoot/#use-ldif-file-for-changingupdating-the-openldap-server","text":"It is possible to update or change openldap server from command line as explain bellow. For example how to add organizational unit using sample.ldif. sample.ldif : dn: ou=users,dc=coppermail,dc=dyndns,dc=org changetype: add objectClass: organizationalUnit objectclass: top ou: users Command to insert a organization unit from coammand line. ldapmodify -H ldap:// -x -D \u201ccn=admin,dc=coppermail,dc=dyndns,dc=org\u201d -w 12345 -f sample.ldif","title":"Use ldif file for changing/updating the openldap server"},{"location":"troubleshoot/#test-the-openldap-server","text":"ldapwhoami -H ldap:// -x above command will check openldap server communication with unsecured parth. You should now be able to upgrade your connections to use STARTTLS by passing the -Z option when using the OpenLDAP utilities. You can force STARTTLS upgrade by passing it twice. Test this by typing: ldapwhoami -H ldap:// -x -ZZ This forces a STARTTLS upgrade. If this is successful, you should see: STARTTLS success anonymous If you mis-configured something, you will likely see an error like this: STARTTLS failure ldap_start_tls: Connect error (-11) additional info: (unknown error code)","title":"Test the openLDAP server"},{"location":"troubleshoot/#advanced-tls-ldap-testing","text":"Command \u201cldapsearch\u201d with debug level 5, it seems succeed in Executing START TLS, and the ldap server\u2019s certificate is valid,but it shows some other strange errors: ldapsearch -ZZ -d 5 If you want to troubleshoot whole TLS communication with ldap server step by step use bellow coammand. ldapsearch -x -ZZ -d1","title":"Advanced TLS - ldap testing"},{"location":"troubleshoot/#database-testing","text":"Now a groupoffice database should be created preor to start groupoffice installation begins. first you have to check what is the pod name of dataase. #kubectl get pods -n monitoring Then exicute followng command to open a mysql client connected with the mysql pod. #kubectl run -it --rm --image=mysql:5.6 --restart=Never mysql-client -n monitoring -- mysql -h mysql -pc0pperDB Then you will get access to the mysql database. Once you connected check databae. SHOW DATABASES; USE copper; SHOW TABLES;","title":"Database Testing"},{"location":"userfeature/","text":"Groupoffice feature user perspective","title":"Groupware Features"},{"location":"userfeature/#groupoffice-feature-user-perspective","text":"","title":"Groupoffice feature user perspective"}]}